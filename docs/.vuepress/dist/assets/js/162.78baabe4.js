(window.webpackJsonp=window.webpackJsonp||[]).push([[162],{593:function(t,v,s){"use strict";s.r(v);var _=s(34),a=Object(_.a)({},(function(){var t=this,v=t.$createElement,s=t._self._c||v;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"浏览器的通信能力"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#浏览器的通信能力"}},[t._v("#")]),t._v(" 浏览器的通信能力")]),t._v(" "),s("h2",{attrs:{id:"用户代理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#用户代理"}},[t._v("#")]),t._v(" 用户代理")]),t._v(" "),s("p",[t._v("浏览器可以代替用户完成http请求，代替用户解析响应结果，所以我们称之为：")]),t._v(" "),s("p",[s("strong",[t._v("用户代理 user agent")])]),t._v(" "),s("p",[t._v("在网络层面，对于前端开发者，必须要知道浏览器拥有的两大核心能力：")]),t._v(" "),s("ul",[s("li",[t._v("自动发出请求的能力")]),t._v(" "),s("li",[t._v("自动解析响应的能力")])]),t._v(" "),s("h3",{attrs:{id:"自动发出请求的能力"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#自动发出请求的能力"}},[t._v("#")]),t._v(" 自动发出请求的能力")]),t._v(" "),s("p",[t._v("当一些事情发生的时候，浏览器会代替用户自动发出http请求，常见的包括：")]),t._v(" "),s("ol",[s("li",[s("p",[s("strong",[t._v("用户在地址栏输入了一个url地址，并按下了回车")])]),t._v(" "),s("p",[t._v("浏览器会自动解析URL，并发出一个"),s("code",[t._v("GET")]),t._v("请求，同时抛弃当前页面。")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("当用户点击了页面中的a元素")])]),t._v(" "),s("p",[t._v("浏览器会拿到a元素的href地址，并发出一个"),s("code",[t._v("GET")]),t._v("请求，同时抛弃当前页面。")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("当用户点击了提交按钮"),s("code",[t._v('<button type="submit">...</button>')])])]),t._v(" "),s("p",[t._v("浏览器会获取按钮所在的"),s("code",[t._v("<form>")]),t._v("元素，拿到它的"),s("code",[t._v("action")]),t._v("属性地址，同时拿到它"),s("code",[t._v("method")]),t._v("属性值，然后把表单中的数据组织到请求体中，发出"),s("code",[t._v("指定方法")]),t._v("的请求，同时抛弃当前页面。")]),t._v(" "),s("blockquote",[s("p",[t._v("这种方式的提交现在越来越少见了")])])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("当解析HTML时遇到了"),s("code",[t._v("<link> <img> <script> <video> <audio>")]),t._v("等元素")])]),t._v(" "),s("p",[t._v("浏览器会拿到对应的地址，发出"),s("code",[t._v("GET")]),t._v("请求")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("当用户点击了刷新")])]),t._v(" "),s("p",[t._v("浏览器会拿到当前页面的地址，以及当前页面的请求方法，重新发一次请求，同时抛弃当前页面。")])])]),t._v(" "),s("blockquote",[s("p",[t._v("浏览器在发出请求时，会自动附带一些请求头")])]),t._v(" "),s("p",[t._v("==重点来了==")]),t._v(" "),s("p",[t._v("从古至今，浏览器都有一个约定：")]),t._v(" "),s("p",[s("strong",[t._v("当发送GET请求时，浏览器不会附带请求体")])]),t._v(" "),s("p",[t._v("这个约定深刻的影响着后续的前后端各种应用，现在，几乎所有人都在潜意识中认同了这一点，无论是前端开发人员还是后端开发人员。")]),t._v(" "),s("p",[t._v("由于前后端程序的默认行为，逐步造成了GET和POST的各种差异：")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("浏览器在发送 GET 请求时，不会附带请求体")])]),t._v(" "),s("li",[s("p",[t._v("GET 请求的传递信息量有限，适合传递少量数据；POST 请求的传递信息量是没有限制的，适合传输大量数据。")])]),t._v(" "),s("li",[s("p",[t._v("GET 请求只能传递 ASCII 数据，遇到非 ASCII 数据需要进行编码；POST 请求没有限制")])]),t._v(" "),s("li",[s("p",[t._v("大部分 GET 请求传递的数据都附带在 path 参数中，能够通过分享地址完整的重现页面，但同时也暴露了数据，若有敏感数据传递，不应该使用 GET 请求，至少不应该放到 path 中")])]),t._v(" "),s("li",[s("p",[t._v("POST 不会被保存到浏览器的历史记录中")])]),t._v(" "),s("li",[s("p",[t._v("刷新页面时，若当前的页面是通过 POST 请求得到的，则浏览器会提示用户是否重新提交。若是 GET 请求得到的页面则没有提示。")])])]),t._v(" "),s("h3",{attrs:{id:"自动解析响应的能力"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#自动解析响应的能力"}},[t._v("#")]),t._v(" 自动解析响应的能力")]),t._v(" "),s("p",[t._v("浏览器不仅能发送请求，还能够针对服务器的各种响应结果做出不同的自动处理")]),t._v(" "),s("p",[t._v("常见的处理有：")]),t._v(" "),s("ol",[s("li",[s("p",[s("strong",[t._v("识别响应码")])]),t._v(" "),s("p",[t._v("浏览器能够自动识别响应码，当出现一些特殊的响应码时浏览器会自动完成处理，比如"),s("code",[t._v("301、302")])])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("根据响应结果做不同的处理")])]),t._v(" "),s("p",[t._v("浏览器能够自动分析响应头中的"),s("code",[t._v("Content-Type")]),t._v("，根据不同的值进行不同处理，比如：")]),t._v(" "),s("ul",[s("li",[s("p",[s("code",[t._v("text/plain")]),t._v(": 普通的纯文本，浏览器通常会将响应体原封不动的显示到页面上")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("text/html")]),t._v("：html文档，浏览器通常会将响应体作为页面进行渲染")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("text/javascript")]),t._v("或"),s("code",[t._v("application/javascript")]),t._v("：js代码，浏览器通常会使用JS执行引擎将它解析执行")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("text/css")]),t._v("：css代码，浏览器会将它视为样式")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("image/jpeg")]),t._v("：浏览器会将它视为jpg图片")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("application/octet-stream")]),t._v("：二进制数据，会触发浏览器下载功能")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("attachment")]),t._v("：附件，会触发下载功能")]),t._v(" "),s("p",[t._v("该值和其他值不同，应放到"),s("code",[t._v("Content-Disposition")]),t._v("头中。")])])])])]),t._v(" "),s("h3",{attrs:{id:"基本流程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#基本流程"}},[t._v("#")]),t._v(" 基本流程")]),t._v(" "),s("blockquote",[s("p",[t._v("访问：https://oss.duyiedu.com/test/index.html")])]),t._v(" "),s("img",{attrs:{src:t.$withBase("/img/network/12.png"),alt:"图片"}}),t._v(" "),s("h2",{attrs:{id:"ajax"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ajax"}},[t._v("#")]),t._v(" AJAX")]),t._v(" "),s("blockquote",[s("p",[t._v("浏览器本身就具备网络通信的能力，但在早期，浏览器并没有把这个能力开放给JS。")]),t._v(" "),s("p",[t._v("最早是微软在IE浏览器中把这一能力向JS开放，让JS可以在代码中实现发送请求，并不会刷新页面，这项技术在2005年被正式命名为AJAX（"),s("strong",[t._v("A")]),t._v("synchronous "),s("strong",[t._v("J")]),t._v("avascript "),s("strong",[t._v("A")]),t._v("nd "),s("strong",[t._v("X")]),t._v("ML）")])]),t._v(" "),s("p",[t._v("AJAX 就是指在web应用程序中异步向服务器发送请求。")]),t._v(" "),s("p",[t._v("它的实现方式有两种，"),s("code",[t._v("XMLHttpRequest 简称XHR")]),t._v("和"),s("code",[t._v("Fetch")])]),t._v(" "),s("p",[t._v("以下是两者的对比")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("功能点")]),t._v(" "),s("th",[t._v("XHR")]),t._v(" "),s("th",[t._v("Fetch")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("基本的请求能力")]),t._v(" "),s("td",[t._v("✅")]),t._v(" "),s("td",[t._v("✅")])]),t._v(" "),s("tr",[s("td",[t._v("基本的获取响应能力")]),t._v(" "),s("td",[t._v("✅")]),t._v(" "),s("td",[t._v("✅")])]),t._v(" "),s("tr",[s("td",[t._v("监控请求进度")]),t._v(" "),s("td",[t._v("✅")]),t._v(" "),s("td",[t._v("❌")])]),t._v(" "),s("tr",[s("td",[t._v("监控响应进度")]),t._v(" "),s("td",[t._v("✅")]),t._v(" "),s("td",[t._v("✅")])]),t._v(" "),s("tr",[s("td",[t._v("Service Worker中是否可用")]),t._v(" "),s("td",[t._v("❌")]),t._v(" "),s("td",[t._v("✅")])]),t._v(" "),s("tr",[s("td",[t._v("控制cookie的携带")]),t._v(" "),s("td",[t._v("❌")]),t._v(" "),s("td",[t._v("✅")])]),t._v(" "),s("tr",[s("td",[t._v("控制重定向")]),t._v(" "),s("td",[t._v("❌")]),t._v(" "),s("td",[t._v("✅")])]),t._v(" "),s("tr",[s("td",[t._v("请求取消")]),t._v(" "),s("td",[t._v("✅")]),t._v(" "),s("td",[t._v("✅")])]),t._v(" "),s("tr",[s("td",[t._v("自定义referrer")]),t._v(" "),s("td",[t._v("❌")]),t._v(" "),s("td",[t._v("✅")])]),t._v(" "),s("tr",[s("td",[t._v("流")]),t._v(" "),s("td",[t._v("❌")]),t._v(" "),s("td",[t._v("✅")])]),t._v(" "),s("tr",[s("td",[t._v("API风格")]),t._v(" "),s("td",[s("code",[t._v("Event")])]),t._v(" "),s("td",[s("code",[t._v("Promise")])])]),t._v(" "),s("tr",[s("td",[t._v("活跃度")]),t._v(" "),s("td",[t._v("停止更新")]),t._v(" "),s("td",[t._v("不断更新")])])])]),t._v(" "),s("h2",{attrs:{id:"实战"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#实战"}},[t._v("#")]),t._v(" 实战")]),t._v(" "),s("h3",{attrs:{id:"请求并获取响应数据"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#请求并获取响应数据"}},[t._v("#")]),t._v(" 请求并获取响应数据")]),t._v(" "),s("p",[t._v("请求地址：https://study.duyiedu.com/api/herolist")]),t._v(" "),s("p",[t._v("请求方法：GET")]),t._v(" "),s("p",[t._v("响应类型：application/json")]),t._v(" "),s("p",[t._v("响应结果：王者荣耀英雄数据")]),t._v(" "),s("h3",{attrs:{id:"上传文件并监控进度"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#上传文件并监控进度"}},[t._v("#")]),t._v(" 上传文件并监控进度")]),t._v(" "),s("h4",{attrs:{id:"准备工作-启动本地文件上传服务器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#准备工作-启动本地文件上传服务器"}},[t._v("#")]),t._v(" 准备工作：启动本地文件上传服务器")]),t._v(" "),s("p",[s("strong",[t._v("如果没有安装node")])]),t._v(" "),s("ol",[s("li",[s("p",[t._v("下载安装node，https://nodejs.org/zh-cn/")])]),t._v(" "),s("li",[s("p",[t._v("打开命令行工具，设置淘宝源")]),t._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" config "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" registry https://registry.npm.taobao.org\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])])])]),t._v(" "),s("p",[s("strong",[t._v("安装依赖")])]),t._v(" "),s("ol",[s("li",[t._v("在命令行进入"),s("code",[t._v("upload-server")]),t._v("目录")]),t._v(" "),s("li",[t._v("运行"),s("code",[t._v("npm i")])])]),t._v(" "),s("p",[s("strong",[t._v("启动服务器")])]),t._v(" "),s("ol",[s("li",[t._v("在命令行进入"),s("code",[t._v("upload-server")]),t._v("目录")]),t._v(" "),s("li",[t._v("运行"),s("code",[t._v("npm start")])])]),t._v(" "),s("h4",{attrs:{id:"上传接口"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#上传接口"}},[t._v("#")]),t._v(" 上传接口")]),t._v(" "),s("p",[t._v("请求路径："),s("code",[t._v("/upload/single")])]),t._v(" "),s("p",[t._v("请求方法："),s("code",[t._v("POST")])]),t._v(" "),s("p",[t._v("消息格式："),s("code",[t._v("multipart/form-data")])]),t._v(" "),s("p",[t._v("字段名称："),s("code",[t._v("avatar")])]),t._v(" "),s("p",[t._v("允许的后缀名："),s("code",[t._v("['.jpg', '.jpeg', '.bmp', '.webp', '.gif', '.png']")])]),t._v(" "),s("p",[t._v("最大尺寸："),s("code",[t._v("1M")])]),t._v(" "),s("p",[t._v("响应格式："),s("code",[t._v("JSON")])]),t._v(" "),s("p",[t._v("响应结果示例：")]),t._v(" "),s("div",{staticClass:"language-json line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 成功")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"data"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"文件的访问地址"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 失败：后缀名不符号要求")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"errCode"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"errMsg"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"后缀名不符合要求"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 失败：文件过大")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"errCode"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"errMsg"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"文件过大"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br")])]),s("h3",{attrs:{id:"chatgpt"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#chatgpt"}},[t._v("#")]),t._v(" ChatGPT")]),t._v(" "),s("h4",{attrs:{id:"准备工作-启动本地服务器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#准备工作-启动本地服务器"}},[t._v("#")]),t._v(" 准备工作：启动本地服务器")]),t._v(" "),s("blockquote",[s("p",[t._v("已安装好node，以及设置好了npm的淘宝源")])]),t._v(" "),s("p",[s("strong",[t._v("安装依赖")])]),t._v(" "),s("ol",[s("li",[t._v("在命令行进入"),s("code",[t._v("chat-server")]),t._v("目录")]),t._v(" "),s("li",[t._v("运行"),s("code",[t._v("npm i")])])]),t._v(" "),s("p",[s("strong",[t._v("启动服务器")])]),t._v(" "),s("ol",[s("li",[t._v("在命令行进入"),s("code",[t._v("chat-server")]),t._v("目录")]),t._v(" "),s("li",[t._v("运行"),s("code",[t._v("npm run dev")])])]),t._v(" "),s("h4",{attrs:{id:"聊天接口"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#聊天接口"}},[t._v("#")]),t._v(" 聊天接口")]),t._v(" "),s("p",[t._v("请求路径："),s("code",[t._v("/chat")])]),t._v(" "),s("p",[t._v("请求方法："),s("code",[t._v("POST")])]),t._v(" "),s("p",[t._v("请求消息格式："),s("code",[t._v("application/json")])]),t._v(" "),s("p",[t._v("请求体格式：")]),t._v(" "),s("div",{staticClass:"language-json line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 清除当前的聊天上下文")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 清除后，服务器不再记录之前的聊天内容，后续的聊天将使用新的上下文")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"clear"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 发送消息")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"content"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"我要你扮演海绵宝宝的魔法海螺壳"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br")])]),s("p",[t._v("响应格式："),s("code",[t._v("纯文本")])]),t._v(" "),s("div",{staticClass:"language-text line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("好的，我现在开始扮演海绵宝宝的魔法海螺壳。我可以说出各种魔法语言和帮助海绵宝宝和派大星解决问题。让我们开始冒险吧！噢呵呵呵呵！\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("注意：响应比较耗时，服务器会流式的将文本发送到客户端，为了提高用户体验，客户端最好流式的接收消息。")])])}),[],!1,null,null,null);v.default=a.exports}}]);